@model TheatreCMS3.Areas.Blog.Models.BlogPhoto

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Details</h2>

<div class="deleteForm-container">
    <h4 class="blogHeader-white">Blog Photo Details</h4>
    <hr />
    <dl>
        <dd>
            <span class="image-title">@Html.DisplayFor(model => model.Title)</span>
        </dd>
        <dd>
            <div class="deleteForm-container">
                <!-- This is where converted byte array (image) will display -->
                <img src="data:image;base64,@System.Convert.ToBase64String(Model.Photo)" class="image-large" />

                <!-- Edit / Back to List / Delete buttons -->
                <form>
                    @Html.ActionLink("Edit", "Edit", null, new { id = Model.BlogPhotoId }, new { @class = "btn btn-edit edit-icon" })
                    @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-back back-icon" })

                    <input type="hidden" asp-for="@Model.BlogPhotoId" />

                    <!-- Opens modal -->
                    <a id="=deleteItem" class="btn btn-delete delete-icon deleteItem" data-target="#deleteModal" data-toggle="modal" data-path="@Url.Action("Delete", "BlogPhotos", new { id = Model.BlogPhotoId })">
                        Delete
                    </a>
                </form>

            </div>
        </dd>
    </dl>
</div>

<!-- Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content modal-bg">
            <div class="modal-header">
                <h5 class="blogHeader" id="deleteModalLabel">Are you sure you would like to delete this image?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-cancel" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn modal-delete" id="deleteBtn" data-toggle="modal" data-target="#deleteModal" data-url="@Url.Action($"Delete/{Model.BlogPhotoId}")">
                    Delete
                </button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var pathToDelete;

    $(".deleteItem").click(function (e) {
        pathToDelete = $(this).data('path');
    });

    $("#deleteBtn").click(function () {
        window.location = pathToDelete;
    });
</script>
