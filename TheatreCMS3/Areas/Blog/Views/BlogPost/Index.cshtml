@model IEnumerable<TheatreCMS3.Areas.Blog.Models.BlogPost>

@{
    ViewBag.Title = "Index";
}

<head>
    <script src="~/Scripts/jquery-3.5.1.min.js"></script>
</head>

<div class="blog-post-div">
    <h2 class="blog-post-header">Blog Post Index</h2>
</div>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

@foreach (var item in Model)
{
    <div class="blog-post-card-container">
        <div class="card blog-post-card">
            <div class="row no-gutters">
                <div class="blog-post-card-thumbnail">
                    <img src="https://picsum.photos/500" class="img-fluid " alt="">
                </div>
                <div class="col px-2 blog-post-flexbox flex-column">
                    <div class="blog-post-card-text-container">
                        <h4 class="blog-post-card-title">@Html.DisplayFor(modelItem => item.Title)</h4>
                        <p class="text-muted">@Html.DisplayFor(modelItem => item.Posted) by @Html.DisplayFor(modelItem => item.Author)</p>
                        <p class="card-text blog-post-spacer2">@Html.DisplayFor(modelItem => item.Content)</p>
                    </div>
                    <div class="blog-post-card-button-container">
                        <a href="@Url.Action("Edit", new { id = item.BlogPostId })" class="btn blog-post-button"><i class="fas fa-edit"></i> Edit</a>
                        <a href="@Url.Action("Details", new { id = item.BlogPostId })" class="btn blog-post-button"><i class="fas fa-info"></i> Details</a>
                        <button type="button" class="btn blog-post-button2" data-toggle="modal" data-target="#confirmDelete" data-item-id="@item.BlogPostId" data-item-description="@item.Title"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<!-- Modal -->
<div class="modal fade" id="confirmDelete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content blog-post-modal-content">
            <div class="modal-header blog-post-modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Delete this Blog Post?</h5>
                <button type="button" class="close blog-post-close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete: <span class="description"></span>
            </div>
            <div class="modal-footer blog-post-modal-footer">
                <button type="button" class="btn blog-post-button" data-dismiss="modal">Close</button>
                @*@using (Html.BeginForm("Delete", "BlogPost", FormMethod.Post))
                    {
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn blog-post-button2"><i class="fas fa-trash"></i> Delete</button> <!-- this button is sizing oddly -->
                    }*@
                <button type="submit" class="btn blog-post-button2">Delete</button>
            </div>
        </div>
    </div>
</div>

@*@using (Html.BeginForm("Delete", "BlogPost"))
    {

    }*@

<script type="text/javascript">
    $('#confirmDelete').on('click', '.btn-ok', function (e) {
        var $modalDiv = $(e.delegateTarget);
        var id = $(this).data('itemId');
        $modalDiv.addClass('loading');
        $.post('/Blog/BlogPost/Delete/' + id).then(function () {
            $modalDiv.modal('hide').removeClass('loading');
        });
    });
    $('#confirmDelete').on('show.bs.modal', function (e) {
        var data = $(e.relatedTarget).data();
        $('.description', this).text(data.itemDescription);
        $('.btn-ok', this).data('itemId', data.itemId);
    });
</script>


@*$.ajax({
        type: "POST",
        url: '@Url.Action("Delete", "BlogPost")',
        data: { id: 10 },
        contentType: 'application/json; charset=utf-8',
        success: function (data) {

        }

    })

    [HttpPost]
    public JsonResult Delete(int id)
    {
        var
    }*@


<!-- Button trigger modal -->
<!--<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
    Launch demo modal
</button>-->
<!-- Modal -->
<!--<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>-->
@*@using (Html.BeginForm("Delete", "BlogPost", FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        <button type="submit" class="btn blog-post-button2"><i class="fas fa-trash"></i> Delete</button>
    }*@

@*<a href="@Url.Action("Delete", new { id = item.BlogPostId })" class="btn blog-post-button2"><i class="fas fa-trash"></i> Delete</a>*@